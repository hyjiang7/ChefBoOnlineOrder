{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/helenjiang/Desktop/ChefBoOnline/ChefBoOnlineOrder/chefbo/pages/routes/checkout.js\";\nimport React, { useState, useContext, useEffect } from \"react\";\nimport moment from \"moment\";\nimport momentz from \"moment-timezone\";\nimport store from \"../../state/GlobalState\";\nimport router, { useRouter } from \"next/router\";\nimport { addCustomerInfo, setTips } from \"../../state/Actions\";\nconst FULL12FORMAT = \"dddd MM-DD-YY HH:mm\";\nconst DATEFORMAT = \"dddd MM-DD-YY\";\nconst TIMEZONE = \"America/Los_Angeles\";\n\nconst checkout = () => {\n  // const closedDays = [\"11/25/2021\", \"12/25/2021\", \"07/04/2022\"]\n  //if lunch special in cart; different hoursOfOperation\n  const lunchSpecialHours = [[], [\"11:00\", \"15:00\"], [\"11:00\", \"15:00\"], [\"11:00\", \"15:00\"], [\"11:00\", \"15:00\"], [\"11:00\", \"15:00\"], [\"12:00\", \"15:00\"]];\n  const hoursOfOperation = [[], //change!!!\n  [\"11:00\", \"15:00\", \"16:30\", \"21:00\"], [\"11:00\", \"15:00\", \"16:30\", \"21:00\"], [\"11:00\", \"15:00\", \"16:30\", \"21:00\"], [\"11:00\", \"15:00\", \"16:30\", \"21:00\"], [\"11:00\", \"15:00\", \"16:30\", \"21:30\"], [\"12:00\", \"15:00\", \"16:30\", \"21:30\"]];\n  var today = moment(moment().format(FULL12FORMAT)).tz(TIMEZONE);\n  const day = today.day(); //number\n\n  const date = today.format(DATEFORMAT); //string\n\n  const todayClose2 = moment.tz(`${date} ${hoursOfOperation[day][3]}`, FULL12FORMAT, TIMEZONE);\n  const open = today.isBefore(todayClose2);\n  var validTimesOne = [];\n  var validDays = [];\n  var validTimesTwo = [];\n  var dateOne;\n  var dateTwo;\n  var dayOneOpen1, dayOneClose1, dayOneOpen2, dayOneClose2;\n  var dayTwoOpen1, dayTwoClose1, dayTwoOpen2, dayTwoClose2; //today is open!\n\n  if (open) {\n    console.log(\"open\");\n    validDays.push(`Today (${date})`);\n    dateOne = date;\n\n    if (day == 6) {\n      //if today is sat, give them today and monday\n      dateTwo = today.add(2, \"days\").format(DATEFORMAT);\n    } else {\n      //today and tmr\n      dateTwo = today.add(1, \"days\").format(DATEFORMAT);\n    }\n\n    validDays.push(dateTwo);\n    today = moment(moment().format(FULL12FORMAT)).tz(TIMEZONE); //reset today\n\n    dayOneOpen1 = moment.tz(`${dateOne} ${hoursOfOperation[day][0]}`, FULL12FORMAT, TIMEZONE);\n    dayOneClose1 = moment.tz(`${dateOne} ${hoursOfOperation[day][1]}`, FULL12FORMAT, TIMEZONE);\n    dayOneOpen2 = moment.tz(`${dateOne} ${hoursOfOperation[day][2]}`, FULL12FORMAT, TIMEZONE);\n    dayOneClose2 = moment.tz(`${dateOne} ${hoursOfOperation[day][3]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoOpen1 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][0]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoClose1 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][1]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoOpen2 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][2]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoClose2 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][3]}`, FULL12FORMAT, TIMEZONE);\n\n    if (today.isBefore(dayOneOpen1)) {\n      //store still open today\n      validTimesOne = availablePickUpTimes(dayOneOpen1, dayOneClose1);\n    } else {\n      validTimesOne = availablePickUpTimes(today, dayOneClose1);\n    }\n\n    validTimesOne = validTimesOne.concat(availablePickUpTimes(dayOneOpen2, dayOneClose2));\n    validTimesTwo = availablePickUpTimes(dayTwoOpen1, dayTwoClose1);\n    validTimesTwo = validTimesTwo.concat(availablePickUpTimes(dayTwoOpen2, dayTwoClose2));\n  } else {\n    console.log(\"closed today\"); //give them options for next two business days\n\n    dateOne = today.add(1, \"days\").format(DATEFORMAT);\n    dateTwo = today.add(1, \"days\").format(DATEFORMAT);\n    validDays.push(dateOne);\n    validDays.push(dateTwo);\n    dayOneOpen1 = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][0]}`, FULL12FORMAT, TIMEZONE);\n    dayOneClose1 = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][1]}`, FULL12FORMAT, TIMEZONE);\n    dayOneOpen2 = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][2]}`, FULL12FORMAT, TIMEZONE);\n    dayOneClose2 = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][3]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoOpen1 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][0]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoClose1 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][1]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoOpen2 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][2]}`, FULL12FORMAT, TIMEZONE);\n    dayTwoClose2 = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][3]}`, FULL12FORMAT, TIMEZONE);\n    today = moment(moment().format(FULL12FORMAT)).tz(TIMEZONE); //reset today\n\n    validTimesOne = availablePickUpTimes(dayOneOpen1, dayOneClose1);\n    validTimesOne = validTimesOne.concat(availablePickUpTimes(dayOneOpen2, dayOneClose2));\n    validTimesTwo = availablePickUpTimes(dayTwoOpen1, dayTwoClose1);\n    validTimesTwo = validTimesTwo.concat(availablePickUpTimes(dayTwoOpen2, dayTwoClose2));\n  }\n\n  function availablePickUpTimes(startTime, endTime) {\n    var timeArr = [];\n    const mins = 15 - startTime.minute() % 15;\n    var firstTime = startTime.add(mins, \"m\");\n    mins == 15 ? null : firstTime.add(15, \"m\");\n\n    while (firstTime.isBefore(endTime)) {\n      timeArr.push(new moment(firstTime).format(\"h:mm a\"));\n      firstTime.add(15, \"m\");\n    }\n\n    return timeArr;\n  }\n\n  function calcTips() {\n    const {\n      subtotal\n    } = store.getState();\n    const tipsPercent = [15, 18, 20, 22];\n    var tips = [];\n    tips.push(\"No Tips\");\n    tipsPercent.forEach(i => {\n      tips.push(`$${subtotal * i.toFixed(2)}`);\n    });\n    console.log(tips);\n    return tips;\n  }\n\n  const {\n    0: dateChange,\n    1: setDateChange\n  } = useState(0);\n  const {\n    0: times,\n    1: setTimes\n  } = useState(validTimesOne);\n  const {\n    0: timeChange,\n    1: setTime\n  } = useState(validTimesOne[0]);\n  const {\n    0: paymentError,\n    1: setPaymentError\n  } = useState(\"\");\n  const {\n    0: tips,\n    1: setTips\n  } = useState([\"\"]);\n  const {\n    0: otherTips,\n    1: setOtherTips\n  } = useState(\"\");\n  useEffect(() => {\n    console.log(\"use effect\");\n    setTips(calcTips());\n\n    if (dateChange == 0) {\n      setTimes(validTimesOne);\n    } else setTimes(validTimesTwo);\n  }, [dateChange]);\n\n  function handleDateChange(e) {\n    setDateChange(e.target.value);\n  }\n\n  function handleTimeChange(e) {\n    setTime(e.target.value);\n  }\n\n  function reviewOrder(e) {\n    //check if payment is valid\n    e.preventDefault();\n    var validPayment = e.target.form.elements.payment.value;\n    var tips = 5.00;\n    console.log(validPayment);\n\n    if (validPayment) {\n      setPaymentError(\"\");\n      const customer = {\n        fname: e.target.form.elements.fname.value,\n        lname: e.target.form.elements.lname.value,\n        email: e.target.form.elements.email.value,\n        phone: e.target.form.elements.phone.value,\n        time: timeChange,\n        payment: e.target.form.elements.payment.value\n      };\n      dateChange == 0 ? customer.date = dateOne : customer.date = dateTwo;\n      store.dispatch(setTips(tips));\n      store.dispatch(addCustomerInfo(customer));\n      router.push(\"/routes/submit\");\n    } else {\n      //add error message to payment invalid\n      setPaymentError(\"Invalid payment method!\");\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"col-12 col-sm-8 col-lg-6 m-auto\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"form\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"\",\n          htmlFor: \"day\",\n          children: \"Select Pick Up Date\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"day\",\n          className: \"form-control\",\n          onChange: handleDateChange,\n          children: validDays.map((i, ind) => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: ind,\n            children: i\n          }, ind, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"\",\n          htmlFor: \"time\",\n          children: \"Select a Time\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"time\",\n          className: \"form-control\",\n          onChange: handleTimeChange,\n          children: times.map((i, ind) => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: `${i}`,\n            children: i\n          }, ind, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"fname\",\n            children: \" First Name* \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"fname\",\n            type: \"text\",\n            className: \"form-control\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"lname\",\n            children: \" Last Name* \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"lname\",\n            type: \"text\",\n            className: \"form-control\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email\",\n          children: \" Email* \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"email\",\n          type: \"email\",\n          className: \"form-control\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"phone\",\n          children: \" Phone number (digits only)* \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"phone\",\n          type: \"tel\",\n          pattern: \"[0-9]{3}[0-9]{3}[0-9]{4}\",\n          className: \"form-control\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Select Tip Amount\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"input-group\",\n          children: [tips.map((i, ind) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-check input-group-prepend w-50\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-check-input\",\n              name: \"tips\",\n              type: \"radio\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"tips\",\n              className: \"form-check-label\",\n              children: [\" \", i, \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 21\n            }, this)]\n          }, ind, true, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 17\n          }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-check\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              ariaLabel: \"Radio button for other tips amount\",\n              className: \"form-check-input\",\n              name: \"tips\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"form-control\",\n              type: \"number\",\n              min: \"0.01\",\n              max: \"25000\",\n              step: \"0.01\",\n              className: \"form-control\",\n              ariaLabel: \"Other Tip amount\",\n              placeholder: \"Other\",\n              name: \"tips\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"payment\",\n          children: [\" \", \"Payment* \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"red\"\n            },\n            children: paymentError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 22\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"payment\",\n          type: \"text\",\n          className: \"form-control\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group d-flex justify-content-center \",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn btn-primary\",\n          onClick: reviewOrder,\n          children: \"Review and Submit Order\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 211,\n    columnNumber: 5\n  }, this);\n};\n\nexport default checkout;","map":{"version":3,"sources":["/Users/helenjiang/Desktop/ChefBoOnline/ChefBoOnlineOrder/chefbo/pages/routes/checkout.js"],"names":["React","useState","useContext","useEffect","moment","momentz","store","router","useRouter","addCustomerInfo","setTips","FULL12FORMAT","DATEFORMAT","TIMEZONE","checkout","lunchSpecialHours","hoursOfOperation","today","format","tz","day","date","todayClose2","open","isBefore","validTimesOne","validDays","validTimesTwo","dateOne","dateTwo","dayOneOpen1","dayOneClose1","dayOneOpen2","dayOneClose2","dayTwoOpen1","dayTwoClose1","dayTwoOpen2","dayTwoClose2","console","log","push","add","availablePickUpTimes","concat","startTime","endTime","timeArr","mins","minute","firstTime","calcTips","subtotal","getState","tipsPercent","tips","forEach","i","toFixed","dateChange","setDateChange","times","setTimes","timeChange","setTime","paymentError","setPaymentError","otherTips","setOtherTips","handleDateChange","e","target","value","handleTimeChange","reviewOrder","preventDefault","validPayment","form","elements","payment","customer","fname","lname","email","phone","time","dispatch","map","ind","color"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\nimport moment from \"moment\";\nimport momentz from \"moment-timezone\"\nimport store from \"../../state/GlobalState\";\nimport router, { useRouter } from \"next/router\";\nimport { addCustomerInfo, setTips } from \"../../state/Actions\";\n\n\n\nconst FULL12FORMAT = \"dddd MM-DD-YY HH:mm\";\nconst DATEFORMAT = \"dddd MM-DD-YY\";\nconst TIMEZONE = \"America/Los_Angeles\";\n\nconst checkout = () => {\n  // const closedDays = [\"11/25/2021\", \"12/25/2021\", \"07/04/2022\"]\n\n  //if lunch special in cart; different hoursOfOperation\n  const lunchSpecialHours = [\n    [],\n    [\"11:00\", \"15:00\"],\n    [\"11:00\", \"15:00\"],\n    [\"11:00\", \"15:00\"],\n    [\"11:00\", \"15:00\"],\n    [\"11:00\", \"15:00\"],\n    [\"12:00\", \"15:00\"],\n  ];\n  \n  const hoursOfOperation = [\n    [], //change!!!\n    [\"11:00\", \"15:00\", \"16:30\", \"21:00\"],\n    [\"11:00\", \"15:00\", \"16:30\", \"21:00\"],\n    [\"11:00\", \"15:00\", \"16:30\", \"21:00\"],\n    [\"11:00\", \"15:00\", \"16:30\", \"21:00\"],\n    [\"11:00\", \"15:00\", \"16:30\", \"21:30\"],\n    [\"12:00\", \"15:00\", \"16:30\", \"21:30\"],\n  ];\n\n\nvar today = moment(moment().format(FULL12FORMAT)).tz(TIMEZONE)\n  const day = today.day(); //number\n  const date = today.format(DATEFORMAT); //string\n  const todayClose2 = moment.tz(`${date} ${hoursOfOperation[day][3]}`, FULL12FORMAT, TIMEZONE);\n  const open = today.isBefore(todayClose2);\n  var validTimesOne = [];\n  var validDays = [];\n  var validTimesTwo = [];\n  var dateOne;\n  var dateTwo;\n  var dayOneOpen1, dayOneClose1, dayOneOpen2, dayOneClose2;\n  var dayTwoOpen1, dayTwoClose1, dayTwoOpen2, dayTwoClose2;\n\n  //today is open!\n  if (open) {\n    console.log(\"open\");\n    validDays.push(`Today (${date})`);\n    dateOne = date;\n    if (day == 6) {\n      //if today is sat, give them today and monday\n      dateTwo = today.add(2, \"days\").format(DATEFORMAT);\n    } else {\n      //today and tmr\n      dateTwo = today.add(1, \"days\").format(DATEFORMAT);\n    }\n    validDays.push(dateTwo);\n\n\n    today = moment(moment().format(FULL12FORMAT)).tz(TIMEZONE) //reset today\n\n    \n\n    dayOneOpen1     = moment.tz(`${dateOne} ${hoursOfOperation[day][0]}`, FULL12FORMAT, TIMEZONE)\n    dayOneClose1    = moment.tz(`${dateOne} ${hoursOfOperation[day][1]}`, FULL12FORMAT, TIMEZONE)\n    dayOneOpen2     = moment.tz(`${dateOne} ${hoursOfOperation[day][2]}`, FULL12FORMAT, TIMEZONE)\n    dayOneClose2    = moment.tz(`${dateOne} ${hoursOfOperation[day][3]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoOpen1     = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][0]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoClose1    = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][1]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoOpen2     = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][2]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoClose2    = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][3]}`, FULL12FORMAT, TIMEZONE)\n\n\n    if (today.isBefore(dayOneOpen1)) { //store still open today\n\n        validTimesOne = availablePickUpTimes(dayOneOpen1, dayOneClose1)\n\n    } else {\n\n        validTimesOne = availablePickUpTimes(today, dayOneClose1)\n\n    }\n    validTimesOne = validTimesOne.concat(availablePickUpTimes(dayOneOpen2, dayOneClose2));\n\n    validTimesTwo = availablePickUpTimes(dayTwoOpen1, dayTwoClose1);\n\n    validTimesTwo = validTimesTwo.concat(availablePickUpTimes(dayTwoOpen2, dayTwoClose2));\n\n  } else {\n    console.log(\"closed today\");\n\n    //give them options for next two business days\n    dateOne = today.add(1, \"days\").format(DATEFORMAT);\n    dateTwo = today.add(1, \"days\").format(DATEFORMAT);\n    validDays.push(dateOne);\n    validDays.push(dateTwo);\n\n\n    dayOneOpen1     = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][0]}`, FULL12FORMAT, TIMEZONE)\n    dayOneClose1    = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][1]}`, FULL12FORMAT, TIMEZONE)\n    dayOneOpen2     = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][2]}`, FULL12FORMAT, TIMEZONE)\n    dayOneClose2    = moment.tz(`${dateOne} ${hoursOfOperation[new moment(dateOne).day()][3]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoOpen1     = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][0]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoClose1    = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][1]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoOpen2     = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][2]}`, FULL12FORMAT, TIMEZONE)\n    dayTwoClose2    = moment.tz(`${dateTwo} ${hoursOfOperation[new moment(dateTwo).day()][3]}`, FULL12FORMAT, TIMEZONE)\n\n    today = moment(moment().format(FULL12FORMAT)).tz(TIMEZONE) //reset today\n\n\n    validTimesOne = availablePickUpTimes(dayOneOpen1, dayOneClose1);\n    validTimesOne = validTimesOne.concat(availablePickUpTimes(dayOneOpen2, dayOneClose2));\n    validTimesTwo = availablePickUpTimes(dayTwoOpen1, dayTwoClose1);\n    validTimesTwo = validTimesTwo.concat(availablePickUpTimes(dayTwoOpen2, dayTwoClose2));\n  }\n\n  function availablePickUpTimes(startTime, endTime) {\n\n    var timeArr = [];\n\n    const mins = 15 - (startTime.minute() % 15);\n    var firstTime = startTime.add(mins, \"m\");\n    mins == 15 ? null : firstTime.add(15, \"m\");\n\n    while (firstTime.isBefore(endTime)) {\n        timeArr.push(new moment(firstTime).format(\"h:mm a\"));\n        firstTime.add(15, \"m\");\n    }\n    return timeArr;\n  }\n\n  function calcTips (){\n    const {  subtotal } = store.getState();\n\n    const tipsPercent = [15, 18, 20, 22]\n    var tips = [];\n    tips.push(\"No Tips\")\n    tipsPercent.forEach((i) =>{\n        tips.push(`$${subtotal*i.toFixed(2)}`)\n    })\n\n    console.log(tips)\n    return tips;\n\n  }\n\n  const [dateChange, setDateChange] = useState(0);\n  const [times, setTimes] = useState(validTimesOne);\n  const [timeChange, setTime] = useState(validTimesOne[0]);\n  const [paymentError, setPaymentError] = useState(\"\");\n  const [tips, setTips] = useState([\"\"]);\n  const [otherTips, setOtherTips] = useState(\"\");\n\n\n\n  useEffect(() => {\n    console.log(\"use effect\");\n    setTips(calcTips())\n      \n    if (dateChange == 0) {\n      setTimes(validTimesOne);\n    } else setTimes(validTimesTwo);\n  }, [dateChange]);\n\n  function handleDateChange(e) {\n    setDateChange(e.target.value);\n  }\n\n  function handleTimeChange(e) {\n    setTime(e.target.value);\n  }\n\n  function reviewOrder(e) {\n    //check if payment is valid\n\n    e.preventDefault();\n    var validPayment = e.target.form.elements.payment.value;\n    var tips = 5.00;\n    console.log(validPayment);\n    if (validPayment) {\n      setPaymentError(\"\");\n      const customer = {\n        fname: e.target.form.elements.fname.value,\n        lname: e.target.form.elements.lname.value,\n        email: e.target.form.elements.email.value,\n        phone: e.target.form.elements.phone.value,\n        time: timeChange,\n        payment: e.target.form.elements.payment.value,\n      };\n\n      dateChange == 0 ? (customer.date = dateOne) : (customer.date = dateTwo);\n\n      store.dispatch(setTips(tips));\n\n      store.dispatch(addCustomerInfo(customer));\n      router.push(\"/routes/submit\");\n    } else {\n      //add error message to payment invalid\n      setPaymentError(\"Invalid payment method!\");\n    }\n  }\n\n  return (\n    <div className=\"col-12 col-sm-8 col-lg-6 m-auto\">\n      <form className=\"form\">\n        <div className=\"form-group\">\n          <label className=\"\" htmlFor=\"day\">\n            Select Pick Up Date\n          </label>\n          <select\n            name=\"day\"\n            className=\"form-control\"\n            onChange={handleDateChange}\n          >\n            {validDays.map((i, ind) => (\n              <option key={ind} value={ind}>\n                {i}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div className=\"form-group\">\n          <label className=\"\" htmlFor=\"time\">\n            Select a Time\n          </label>\n          <select\n            name=\"time\"\n            className=\"form-control\"\n            onChange={handleTimeChange}\n          >\n              {/* <option>{times.length}</option> */}\n            {times.map((i, ind) => (\n              <option key={ind} value={`${i}`}>\n                {i}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div className=\"row\">\n          <div className=\"col mb-2\">\n            <label htmlFor=\"fname\"> First Name* </label>\n            <input name=\"fname\" type=\"text\" className=\"form-control\" required />\n          </div>\n\n          <div className=\"col\">\n            <label htmlFor=\"lname\"> Last Name* </label>\n            <input name=\"lname\" type=\"text\" className=\"form-control\" required />\n          </div>\n        </div>\n\n        <div className=\"form-group\">\n          <label htmlFor=\"email\"> Email* </label>\n          <input name=\"email\" type=\"email\" className=\"form-control\" required />\n        </div>\n\n        <div className=\"form-group\">\n          <label htmlFor=\"phone\"> Phone number (digits only)* </label>\n          <input\n            name=\"phone\"\n            type=\"tel\"\n            pattern=\"[0-9]{3}[0-9]{3}[0-9]{4}\"\n            className=\"form-control\"\n            required\n          />\n        </div>\n\n        <div className=\"\">\n            <p>Select Tip Amount</p>\n            <div className=\"input-group\">\n\n            {tips.map((i, ind) =>(\n\n                <div className=\"form-check input-group-prepend w-50\" key={ind}>\n                    <input\n                    className=\"form-check-input\"\n                      name=\"tips\"\n                      type=\"radio\"\n                      required\n                    />\n                    <label htmlFor=\"tips\" className=\"form-check-label\"> {i} </label>\n                </div>\n           \n\n            ))}\n\n\n                <div className=\"form-check\">\n                <input type=\"radio\" ariaLabel=\"Radio button for other tips amount\" className=\"form-check-input\" name=\"tips\"/></div>\n                <div className=\"\">\n                <input className=\"form-control\" type=\"number\" min=\"0.01\" max=\"25000\" step=\"0.01\" className=\"form-control\" ariaLabel=\"Other Tip amount\" placeholder=\"Other\" name=\"tips\"/>\n                </div>\n        </div>\n        </div>\n\n\n        <div className=\"form-group\">\n          <label htmlFor=\"payment\">\n            {\" \"}\n            Payment* <span style={{ color: \"red\" }}>{paymentError}</span>\n          </label>\n          <input name=\"payment\" type=\"text\" className=\"form-control\" />\n        </div>\n\n        <div className=\"form-group d-flex justify-content-center \">\n          <button\n            type=\"submit\"\n            className=\"btn btn-primary\"\n            onClick={reviewOrder}\n          >\n            Review and Submit Order\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default checkout;\n"]},"metadata":{},"sourceType":"module"}